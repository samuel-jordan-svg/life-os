<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sam's Life OS</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
--bg:#0d0d12;--card:#1a1a24;--purple:#8b5cf6;--cyan:#06b6d4;--green:#10b981;--orange:#f59e0b;--red:#ef4444;
--text:#fff;--text2:#9ca3af;--border:rgba(255,255,255,0.08)
}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
.c{max-width:420px;margin:0 auto;padding:20px;padding-bottom:100px}
.h{background:linear-gradient(135deg,rgba(139,92,246,0.25),rgba(6,182,212,0.15));border-radius:28px;padding:32px 24px;margin-bottom:20px;border:1px solid var(--border)}
.g{font-size:14px;color:var(--text2);font-weight:500}
.t{font-size:48px;font-weight:700;color:#fff;margin-top:8px}
.d{font-size:13px;color:var(--text2);margin-top:4px}
.s{display:flex;justify-content:space-between;margin-top:24px}
.si{text-align:center;flex:1}
.si:not(:last-child){border-right:1px solid var(--border)}
.sv{font-size:18px;font-weight:700}
.sl{font-size:9px;color:var(--text2);text-transform:uppercase;margin-top:4px}
.sv.green{color:var(--green)}
.sv.cyan{color:var(--cyan)}
.sv.orange{color:var(--orange)}
.sec{background:var(--card);border-radius:24px;padding:20px;margin-bottom:16px}
.sh{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.slft{display:flex;align-items:center;gap:12px}
.si2{width:42px;height:42px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:18px;background:linear-gradient(135deg,rgba(139,92,246,0.2),rgba(6,182,212,0.15))}
.st{font-size:15px;font-weight:600}
.tag{display:inline-block;padding:3px 8px;background:rgba(139,92,246,0.15);color:var(--purple);border-radius:6px;font-size:9px;font-weight:600;text-transform:uppercase}
.tag.green{background:rgba(16,185,129,0.15);color:var(--green)}
.tag.orange{background:rgba(245,158,11,0.15);color:var(--orange)}
.tag.cyan{background:rgba(6,182,212,0.15);color:var(--cyan)}
.tag.red{background:rgba(239,68,68,0.15);color:var(--red)}
.hi{display:flex;align-items:center;gap:12px;padding:12px;background:rgba(255,255,255,0.03);border-radius:12px;margin-bottom:8px}
.hc{width:26px;height:26px;border-radius:6px;border:2px solid var(--orange);display:flex;align-items:center;justify-content:center}
.hc.checked{background:var(--green);border-color:var(--green)}
.hc.evening{border-color:var(--cyan)}
.hc.evening.checked{background:var(--cyan);border-color:var(--cyan)}
.hc.checked::after{content:'‚úì';color:white;font-size:12px;font-weight:bold}
.hn{flex:1}
.hn2{font-size:13px;font-weight:500}
.hd{font-size:11px;color:var(--text2);margin-top:2px}
.quick-nav{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:20px}
.nav-btn{background:var(--card);border-radius:16px;padding:16px 8px;text-align:center;cursor:pointer;border:1px solid var(--border)}
.nav-btn span{display:block;font-size:10px;color:var(--text2);margin-top:6px}
.nav-btn span:first-child{font-size:24px}
.nav-btn:hover{border-color:var(--purple)}
.nav-btn:active{background:rgba(139,92,246,0.2)}
.nav{position:fixed;bottom:0;left:0;right:0;background:linear-gradient(180deg,#13131a,#0d0d12);border-top:1px solid var(--border);display:flex;justify-content:space-around;padding:12px 8px 25px;z-index:100}
.nav-item{display:flex;flex-direction:column;align-items:center;gap:4px;color:var(--text2);font-size:10px;cursor:pointer}
.nav-item.active{color:var(--purple)}
.nav-item i{font-size:20px}
input,select{width:100%;padding:12px;background:rgba(255,255,255,0.05);border:1px solid var(--border);border-radius:10px;color:#fff;font-size:14px;margin-bottom:10px}
.btn{width:100%;padding:14px;background:linear-gradient(135deg,var(--purple),var(--cyan));border:none;border-radius:10px;color:#fff;font-size:14px;font-weight:600;cursor:pointer;margin-top:10px}
@media(max-width:767px){.c{padding:16px}.h{padding:24px 20px;border-radius:20px}.t{font-size:40px}}
</style>
</head>
<body>

<!-- Dashboard Page -->
<div id="page-dashboard" class="page">
<div class="c">
<div class="h">
<div class="g">SAM'S LIFE OS</div>
<div class="t" id="clock">--:--</div>
<div class="d" id="dayInfo">Loading...</div>
<div class="s">
<div class="si"><div class="sv" id="yearPct">--%</div><div class="sl">YEAR</div></div>
<div class="si"><div class="sv cyan" id="daysTo">--</div><div class="sl">DAYS</div></div>
<div class="si"><div class="sv green" id="debt">¬£15.4k</div><div class="sl">DEBT</div></div>
</div>
</div>

<!-- Quick Nav -->
<div class="quick-nav">
<div class="nav-btn" onclick="showPage('money')"><span>üí∞</span><span>Money</span></div>
<div class="nav-btn" onclick="showPage('health')"><span>‚ù§Ô∏è</span><span>Health</span></div>
<div class="nav-btn" onclick="showPage('tasks')"><span>üìã</span><span>Tasks</span></div>
<div class="nav-btn" onclick="showPage('settings')"><span>‚öôÔ∏è</span><span>Settings</span></div>
</div>

<!-- Todoist Due Today -->
<div class="sec">
<div class="sh"><div class="slft"><div class="si2">‚úÖ</div><div class="st">Due Today</div></div><span class="tag" id="todoist-count">0 tasks</span></div>
<div id="todoist-tasks" style="font-size:13px;color:var(--text2)"></div>
<button class="btn" onclick="loadTodoist()" style="background:var(--cyan)">Refresh</button>
</div>

<!-- Morning Habits -->
<div class="sec">
<div class="sh"><div class="slft"><div class="si2" style="background:linear-gradient(135deg,rgba(245,158,11,0.4),rgba(251,191,36,0.3))">üåÖ</div><div class="st">Morning</div></div><span class="tag orange" id="mornProg">0/6</span></div>
<div id="mornHabits"></div>
</div>

<!-- Evening Habits -->
<div class="sec">
<div class="sh"><div class="slft"><div class="si2" style="background:linear-gradient(135deg,rgba(6,182,212,0.4),rgba(34,211,238,0.3))">üåô</div><div class="st">Evening</div></div><span class="tag cyan" id="eveProg">0/5</span></div>
<div id="eveHabits"></div>
</div>
</div>
</div>

<!-- Money Page -->
<div id="page-money" class="page" style="display:none">
<div class="c">
<div class="h">
<div class="g">FINANCIAL COMMAND CENTER</div>
<div class="t" id="clockM">--:--</div>
<div class="d" id="dayInfoM">Loading...</div>
</div>
<div class="sec">
<div class="sh"><div class="slft"><div class="si2">üìä</div><div class="st">Monthly Summary</div></div></div>
<div class="s" style="margin-bottom:0">
<div class="si"><div class="sv green">¬£1,872</div><div class="sl">INCOME</div></div>
<div class="si"><div class="sv red" id="fixedTotal">¬£0</div><div class="sl">PAID</div></div>
<div class="si"><div class="sv orange" id="totalDebt">¬£15,402</div><div class="sl">DEBT</div></div>
<div class="si"><div class="sv cyan" id="remaining">¬£1,872</div><div class="sl">AVAILABLE</div></div>
</div>
</div>
<div class="sec">
<div class="sh"><div class="slft"><div class="si2">üìÑ</div><div class="st">Fixed Bills</div></div><span class="tag" id="billCount">0 paid</span></div>
<div id="billsList"></div>
</div>
<div class="sec">
<div class="sh"><div class="slft"><div class="si2">üí≥</div><div class="st">Debts</div></div><span class="tag red" id="debtCount">5 debts</span></div>
<div id="debtsList"></div>
</div>
</div>
</div>

<!-- Health Page -->
<div id="page-health" class="page" style="display:none">
<div class="c">
<div class="h"><div class="g">HEALTH</div><div class="t" id="clockH">--:--</div><div class="d" id="dayInfoH">Loading...</div></div>
<div class="sec"><div class="st">üèÉ Running 500km</div><div style="margin:12px 0;color:var(--text2)">0 / 500km</div></div>
<div class="sec"><div class="st">üìö Reading 24 books</div><div style="margin:12px 0;color:var(--text2)">0 / 24</div></div>
</div>
</div>

<!-- Tasks Page -->
<div id="page-tasks" class="page" style="display:none">
<div class="c">
<div class="h"><div class="g">TASKS</div><div class="t" id="clockT">--:--</div><div class="d" id="dayInfoT">Loading...</div></div>
<div class="sec"><div class="st">üìã Todoist</div><p style="color:var(--text2);margin-top:12px">Full Todoist integration coming soon</p></div>
</div>
</div>

<!-- Settings Page -->
<div id="page-settings" class="page" style="display:none">
<div class="c">
<div class="h"><div class="g">SETTINGS</div><div class="t" id="clockS">--:--</div><div class="d" id="dayInfoS">Loading...</div></div>
<div class="sec"><div class="st">‚öôÔ∏è Data Backup</div>
<p style="color:var(--text2);margin-top:12px;margin-bottom:16px">Export before clearing cache!</p>
<button class="btn" onclick="exportData()" style="background:var(--green)">Export Backup</button>
<button class="btn" onclick="importData()" style="background:var(--cyan)">Import Backup</button>
</div>
<div class="sec"><div class="st">üîó Todoist API</div>
<p style="color:var(--text2);margin-top:12px;margin-bottom:16px">Token saved automatically</p>
<input type="password" id="todoist-token" placeholder="API token (optional)" onchange="saveTodoistToken()">
</div>
</div>
</div>

<!-- Bottom Nav -->
<nav class="nav">
<div class="nav-item active" onclick="showPage('dashboard',this)"><i class="fas fa-home"></i><span>Home</span></div>
<div class="nav-item" onclick="showPage('money',this)"><i class="fas fa-pound-sign"></i><span>Money</span></div>
<div class="nav-item" onclick="showPage('health',this)"><i class="fas fa-heart"></i><span>Health</span></div>
<div class="nav-item" onclick="showPage('tasks',this)"><i class="fas fa-tasks"></i><span>Tasks</span></div>
<div class="nav-item" onclick="showPage('settings',this)"><i class="fas fa-cog"></i><span>Settings</span></div>
</nav>

<script>
// Habits
const MORN=[{n:'‚è∞ Wake 6am',d:'Wake at 6am'},{n:'üå≥ Outside 10min',d:'Stand outside'},{n:'üíß Water',d:'Big glass'},{n:'üßò Stretch',d:'Stretching'},{n:'‚òï Coffee',d:'1hr after wake'},{n:'‚úçÔ∏è Write',d:'Win+Thing+Obstacle'}];
const EVE=[{n:'üçΩÔ∏è Meal 4hrs bed',d:'Final meal'},{n:'üìµ Screens off',d:'60min before bed'},{n:'üìñ Read',d:'10min read'},{n:'‚òï No caffeine',d:'Avoid stimulants'},{n:'üí° Red lights',d:'Amber lights'}];

// Bills
let bills=[
{id:'rent',n:'üè† Rent (girlfriend)',a:500,m:500,p:false},
{id:'phone',n:'üì± Phone',a:48.09,m:48.09,p:false},
{id:'carIns',n:'üöó Car Insurance',a:32.50,m:32.50,p:false},
{id:'sky',n:'üì∫ Sky',a:53.00,m:53.00,p:false},
{id:'life',n:'‚ù§Ô∏è Life Insurance',a:4.99,m:4.99,p:false},
{id:'kia',n:'üöó Kia Finance (PCP)',a:198.29,m:198.29,p:false}
];

// Debts
let debts=[
{id:'argos',n:'üè™ Argos Card',b:320,min:51.10,apr:0,end:'2026-06-14'},
{id:'monzo',n:'üè¶ Monzo IFL',b:40,min:40,apr:0,end:null},
{id:'virgin',n:'üí≥ Virgin Money',b:2555.23,min:51.10,apr:26.49,end:'2027-09-16'},
{id:'lendable',n:'üè¶ Lendable',b:11876.71,min:264.25,apr:15.8,end:null},
{id:'zopa',n:'üí≥ Zopa Spend',b:0,min:0,apr:34.4,end:null}
];

let history=[];

function showPage(pageName,el){
  document.querySelectorAll('.page').forEach(function(p){p.style.display='none'});
  document.getElementById('page-'+pageName).style.display='block';
  document.querySelectorAll('.nav-item').forEach(function(n){n.classList.remove('active')});
  if(el)el.classList.add('active');
  updateClocks();
}

function loadAll(){
  var ld=localStorage.getItem('lifeOSdebts');
  if(ld)debts=JSON.parse(ld);
  var lb=localStorage.getItem('lifeOSbills');
  if(lb)bills=JSON.parse(lb);
  var lh=localStorage.getItem('lifeOShistory');
  if(lh)history=JSON.parse(lh);
  calcTotals();
}

function saveAll(){
  localStorage.setItem('lifeOSdebts',JSON.stringify(debts));
  localStorage.setItem('lifeOSbills',JSON.stringify(bills));
  localStorage.setItem('lifeOShistory',JSON.stringify(history));
  calcTotals();
}

function calcTotals(){
  var totDebt=debts.reduce(function(a,b){return a+(b.paid?0:b.b)},0);
  var totBill=bills.filter(function(b){return b.p}).reduce(function(a,b){return a+b.m},0);
  var today=new Date().toLocaleDateString('en-GB');
  var todayPayments=history.filter(function(h){return h.d===today}).reduce(function(a,h){return a+parseFloat(h.a)},0);
  var inc=1872.44;
  var available=inc-totBill-todayPayments;
  document.getElementById('totalDebt').textContent='¬£'+totDebt.toLocaleString();
  document.getElementById('fixedTotal').textContent='¬£'+totBill.toFixed(2);
  document.getElementById('remaining').textContent='¬£'+available.toFixed(2);
  document.getElementById('debt').textContent=totDebt<10000?'¬£'+(totDebt/1000).toFixed(1)+'k':'¬£'+(totDebt/1000).toFixed(1)+'k';
  document.getElementById('billCount').textContent=bills.filter(function(b){return b.p}).length+' paid';
  document.getElementById('debtCount').textContent=debts.filter(function(d){return !d.paid}).length+' debts';
}

function checkDayReset(){
  var today=new Date().toISOString().split('T')[0];
  var lastDate=localStorage.getItem('lifeOSlastDate');
  if(lastDate!==today){
    localStorage.setItem('morn','{}');
    localStorage.setItem('eve','{}');
    localStorage.setItem('lifeOSlastDate',today);
  }
}

function renderHabits(){
  var ms=JSON.parse(localStorage.getItem('morn')||'{}');
  var es=JSON.parse(localStorage.getItem('eve')||'{}');
  var mc=MORN.reduce(function(a,x,i){return a+(ms[i]?1:0)},0);
  var ec=EVE.reduce(function(a,x,i){return a+(es[i]?1:0)},0);
  document.getElementById('mornHabits').innerHTML=MORN.map(function(x,i){
    return '<div class="hi" onclick="toggleHabit(\'morn\','+i+')"><div class="hc '+(ms[i]?'checked':'')+'"></div><div class="hn"><div class="hn2">'+x.n+'</div><div class="hd">'+x.d+'</div></div></div>';
  }).join('');
  document.getElementById('eveHabits').innerHTML=EVE.map(function(x,i){
    return '<div class="hi" onclick="toggleHabit(\'eve\','+i+')"><div class="hc evening '+(es[i]?'checked':'')+'"></div><div class="hn"><div class="hn2">'+x.n+'</div><div class="hd">'+x.d+'</div></div></div>';
  }).join('');
  document.getElementById('mornProg').textContent=mc+'/6';
  document.getElementById('eveProg').textContent=ec+'/5';
}

function toggleHabit(type,i){
  var key=type==='morn'?'morn':'eve';
  var s=JSON.parse(localStorage.getItem(key)||'{}');
  s[i]=!s[i];
  localStorage.setItem(key,JSON.stringify(s));
  renderHabits();
}

function renderBills(){
  document.getElementById('billsList').innerHTML=bills.map(function(b){
    return '<div class="hi" onclick="toggleBill(\''+b.id+'\')"><span>'+b.n+'</span><span>¬£'+b.m.toFixed(2)+'</span></div>';
  }).join('');
}

function toggleBill(id){
  var b=bills.find(function(x){return x.id===id});
  if(b){
    b.p=!b.p;
    saveAll();
    renderBills();
  }
}

function renderDebts(){
  document.getElementById('debtsList').innerHTML=debts.map(function(x){
    var bal=x.paid?'PAID':'¬£'+x.b.toLocaleString();
    var balClass=x.paid?'paid':'active';
    var end=x.end?'0% ends '+x.end:x.apr+'% APR';
    return '<div class="hi"><span>'+x.n+'</span><span class="'+balClass+'">'+bal+'</span></div>';
  }).join('');
}

function saveTodoistToken(){
  localStorage.setItem('todoistToken',document.getElementById('todoist-token').value.trim());
  loadTodoist();
}

function loadTodoist(){
  var token=localStorage.getItem('todoistToken');
  if(!token)return;
  fetch('https://api.todoist.com/rest/v2/tasks',{headers:{'Authorization':'Bearer '+token}})
    .then(function(r){return r.json()})
    .then(function(tasks){
      var today=new Date().toISOString().split('T')[0];
      var overdue=tasks.filter(function(t){return t.due&&t.due.date<today});
      var dueToday=tasks.filter(function(t){return t.due&&t.due.date===today});
      var html='';
      if(overdue.length>0){
        html+=overdue.map(function(t){return '<div style="color:var(--red);padding:8px;margin-bottom:6px;background:rgba(239,68,68,0.15);border-radius:8px">‚ö†Ô∏è '+t.content+'</div>'}).join('');
      }
      if(dueToday.length>0){
        html+=dueToday.map(function(t){return '<div style="padding:8px;margin-bottom:6px;background:rgba(139,92,246,0.15);border-radius:8px">‚óã '+t.content+'</div>'}).join('');
      }
      document.getElementById('todoist-tasks').innerHTML=html||'All caught up!';
      var total=overdue.length+dueToday.length;
      document.getElementById('todoist-count').textContent=total+(total===1?' task':' tasks');
    })
    .catch(function(e){document.getElementById('todoist-tasks').innerHTML='Error loading tasks'});
}

function exportData(){
  var data={bills:bills,debts:debts,history:history,exported:new Date().toISOString()};
  var blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  var a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='life-os-backup-'+new Date().toISOString().split('T')[0]+'.json';
  a.click();
}

function importData(){
  var input=document.createElement('input');
  input.type='file';
  input.accept='.json';
  input.onchange=function(e){
    var reader=new FileReader();
    reader.onload=function(ev){
      try{
        var data=JSON.parse(ev.target.result);
        if(data.bills)bills=data.bills;
        if(data.debts)debts=data.debts;
        if(data.history)history=data.history;
        saveAll();
        renderBills();
        renderDebts();
      }catch(err){alert('Invalid file');}
    };
    reader.readAsText(e.target.files[0]);
  };
  input.click();
}

function updateClocks(){
  var n=new Date();
  var t=n.toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});
  var d=n.toLocaleDateString('en-GB',{weekday:'long',day:'numeric',month:'long'});
  ['clock','clockM','clockH','clockT','clockS'].forEach(function(x){var e=document.getElementById(x);if(e)e.textContent=t});
  ['dayInfo','dayInfoM','dayInfoH','dayInfoT','dayInfoS'].forEach(function(x){var e=document.getElementById(x);if(e)e.textContent=d});
  document.getElementById('yearPct').textContent=Math.round((n.getDate()/365)*100)+'%';
  document.getElementById('daysTo').textContent=Math.ceil((new Date('2026-03-02')-n)/(1000*60*60*24));
}

checkDayReset();
loadAll();
renderHabits();
renderBills();
renderDebts();
if(localStorage.getItem('todoistToken')){
  document.getElementById('todoist-token').value=localStorage.getItem('todoistToken');
  loadTodoist();
}
setInterval(updateClocks,1000);
updateClocks();
</script>
</body>
</html>
